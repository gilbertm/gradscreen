<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>React Test</title>
</head>

<link rel="stylesheet" href="/css/site.css" type="text/css" />
<link href="/images/system/1920x800/StyleSheet.css" type="text/css" rel="stylesheet" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/react.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="/js/site.js"></script>

    <script type="text/jsx">

        
        var Teleprompt = React.createClass({
            
            getInitialState: function() {
                return { beingDisplayedGraduate: [], beingDisplayedGraduateId: 0 };
            },
        
            componentDidMount: function() {
                setInterval(this.loadFromServer, 500);
            },

            screenChange: function() {
                return "changed";
            },

            getBeingDisplayedGraduate: function() {
                return this.state.beingDisplayedGraduate;
            },

            loadFromServer: function() {
                fetch('/api/graduate').then(response => response.json()).then(json => {
                   
                        // trigger state change
                        // empty graduate teleprompt (screen data)
                        if (json == null) {
                            this.setState( { beingDisplayedGraduate : null } );
                        }

                        if (json != null) {
                            var beingDisplayedGraduate = this.getBeingDisplayedGraduate();

                            // trigger state change
                            // update the currently displayed graduate with the json result
                            if (json.graduateId != beingDisplayedGraduate) {
                                this.setState( { beingDisplayedGraduate : json } );
                            }
              
                        }
            
                });
            }, 

            render: function() {
                return <div>
                        {this.getBeingDisplayedGraduate() ? 
                        (
                            <h1>{this.getBeingDisplayedGraduate().graduateId}</h1>
                        ) : (
                                <h1>Nothing</h1>
                            )
                        }
                     </div>;
            }
        });

        React.render(<Teleprompt />, document.getElementById("content"));

        

    </script>
<body class="layout-wrapper">
    <div class="main-wrapper">>
        <div id="content"></div>
   </div>

    <div class="school-flag">
        <span id="date" class="date">/images/system/1920x800/maple-architecture.png</span>
        <span id="maple" class="maple">/images/system/1920x800/date-architecture.png</span>
    </div>

</body>
</html>